---
title: 'Solutions chapter 2 - Geocomputation with R'
author: Jorge Cimentada
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: html_document
---

```{r knitr-setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      message = FALSE,
                      warning = FALSE,
                      fig.path = "../figs/",
                      fig.align = "center",
                      fig.asp = 0.618,
                      out.width = "80%")
```


# Notes

```{r }
library(sf)          # classes and functions for vector data
library(raster)
library(spData)        # load geographic data
library(spDataLarge)   # load larger geographic data
```

* Polygons are triangles, hexagons, [etc..](https://www.google.com/search?q=polygons&client=ubuntu&hs=cv5&channel=fs&sxsrf=ACYBGNSFXdoBGTZj7lM_eIktJZOvrAp1Qw:1573134047025&source=lnms&tbm=isch&sa=X&ved=0ahUKEwjnhLqAndjlAhUBDewKHfWOCbsQ_AUIESgB&biw=1760&bih=812#imgrc=nCyiyGCImczGoM)

* Coordinates are relative to a point of reference. For example, the coordinates c(-0.1, 55.5) are degrees of distance relative to the center c(0, 0) which is in the equator.


```{r }
world_asia <- world[world$continent == "Asia", ]
asia <- st_union(world_asia)

# `add = TRUE` adds a plot to the previous plot
plot(world['pop'], reset = FALSE)
plot(asia, add = TRUE, col = "red")

```


Note that `world` contains the coordinates of the lines that define each country. `st_centroid` below just takes that column a calculate the point in the center (`centroid`) of those limits.

```{r }

plot(world["continent"], reset = FALSE)
cex = sqrt(world$pop) / 10000
world_cents = st_centroid(world, of_largest = TRUE)
plot(st_geometry(world_cents), add = TRUE)

```


```{r }

india <- world[world$name_long == "India", ]
plot(st_geometry(india), expandBB = c(0, 0.2, 0.1, 1), col = "gray", lwd = 3)
plot(world_asia[0], add = TRUE)

```


How do you define points, lines or polygons in `sf`?

* POINT (1 2)
* LINE (3 4, 4 4, 5 5, ...)
* LINESTRING ((1 5, 2 2, 4 1))

All other representations build upon this.

```{r }

# st_* objects or the simple point, line, polygon, etc..
# are `sfg` classes
multipoint_matrix <- rbind(c(5, 2), c(1, 3))
plot(st_multipoint(multipoint_matrix))


multiline_matrix <- list(rbind(c(5, 2), c(1, 3)), rbind(c(9, 1), c(9, 5)))
plot(st_multilinestring(multiline_matrix))


geom_collect <-
  st_geometrycollection(list(st_multipoint(multipoint_matrix),
                             st_multilinestring(multiline_matrix)))

plot(geom_collect)

point1 <- st_point(c(5, 2))
point2 <- st_point(c(1, 3))


points_sfc <- st_sfc(point1, point2)
points_sfc

polygon_list1 <- list(rbind(c(1, 5), c(2, 2), c(4, 1), c(4, 4), c(1, 5)))
polygon1 <- st_polygon(polygon_list1)

polygon_list2 <- list(rbind(c(5, 7), c(2, 2), c(4, 1), c(4, 4), c(5, 7)))
polygon2 <- st_polygon(polygon_list2)

# The combination of `sfg` objects into sfc turns them into a class
# `sfc`.
polygon_sfc <- st_sfc(list(polygon1, polygon2))
polygon_sfc

st_geometry_type(polygon_sfc)

line_list1 <- rbind(c(1, 5), c(2, 2), c(4, 1), c(4, 4), c(1, 5))
list1 <- st_linestring(line_list1)

line_list2 <- rbind(c(5, 7), c(2, 2), c(4, 1), c(4, 4))
list2 <- st_linestring(line_list2)

linestr_sfc <- st_sfc(list(list1, list2))
linestr_sfc

st_geometry_type(linestr_sfc)

st_sfc(point1, list1)

```

You left in exercise 2.2.8: https://geocompr.robinlovelace.net/spatial-class.html
